<!DOCTYPE html>
<html>
<head>
    <title>Welcome</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .messages {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 4px;
        }
        .messages.error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .messages.success {
            background-color: #d4edda;
            color: #155724;
        }
        .nav {
            margin-bottom: 20px;
        }
        .nav a {
            margin-right: 15px;
            text-decoration: none;
            color: purple;
        }
        .nav a:hover {
            text-decoration: underline;
        }
        h1 {
            color: #222;
        }
    </style>
</head>
<body>
    <div class="nav">
        {% if user.is_authenticated %}
            <a href="{% url 'ecommerce:welcome' %}">Home</a>
            <a href="{% url 'ecommerce:catalog_store_list' %}">Browse Stores</a>
            <a href="{% url 'ecommerce:view_cart' %}">Cart</a>
            {% if perms.ecommerce.can_change_product_price %}
                <a href="{% url 'ecommerce:change_price' %}">Change Product Price</a>
            {% endif %}
            <a href="{% url 'ecommerce:logout' %}">Logout</a>
        {% else %}
            <a href="{% url 'ecommerce:login' %}">Login</a>
            <a href="{% url 'ecommerce:register' %}">Register</a>
            <a href="{% url 'ecommerce:catalog_store_list' %}">Browse Stores</a>
        {% endif %}
    </div>

    {% if messages %}
        {% for message in messages %}
            <div class="messages {{ message.tags }}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <h1>
        {% if user.is_authenticated %}
            Welcome to the eCommerce site, {{ request.user.username }}!
        {% else %}
            Welcome to the eCommerce site!
        {% endif %}
    </h1>

    {% if user.is_authenticated %}
        <p>You are now logged in.</p>

        <!-- Quick test form to add items to the cart -->
        <form method="post" action="{% url 'ecommerce:add_to_cart' %}">
            {% csrf_token %}
            <input type="number" name="product_id" placeholder="Product ID" required>
            <input type="number" name="qty" value="1" min="1" required>
            <button type="submit">Add to cart</button>
        </form>
    {% else %}
        <p>Please <a href="{% url 'ecommerce:login' %}">log in</a> to start shopping, or <a href="{% url 'ecommerce:catalog_store_list' %}">browse stores</a> as a guest.</p>
    {% endif %}
</body>
</html>
